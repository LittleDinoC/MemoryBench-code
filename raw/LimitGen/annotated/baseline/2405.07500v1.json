{
    "title": "PromptLink: Leveraging Large Language Models for Cross-Source Biomedical Concept Linking",
    "abstract": "Linking (aligning) biomedical concepts across diverse data sources enables various integrative analyses but is challenging due to the discrepancies in concept naming conventions. Various strategies have been developed to overcome this challenge, such as those based on string-matching rules, manually crafted thesauri, and machine learning models. However, these methods are constrained by limited prior biomedical knowledge and can hardly generalize beyond the limited amounts of rules, thesauri, or training samples. Recently, large language models (LLMs) have exhibited impressive results in diverse biomedical NLP tasks due to their unprecedentedly rich prior knowledge and strong zero-shot prediction abilities. However, LLMs suffer from issues including high costs, limited context length, and unreliable predictions. In this research, we propose PromptLink, a novel biomedical concept linking framework that leverages LLMs. It first employs a biomedical-specialized pre-trained language model to generate candidate concepts that can fit in the LLM context windows. Then it utilizes an LLM to link concepts through two-stage prompts, where the first-stage prompt aims to elicit the biomedical prior knowledge from the LLM for the concept linking task and the second-stage prompt enforces the LLM to reflect on its own predictions to further enhance their reliability. Empirical results on the concept linking task between two EHR datasets and an external biomedical KG demonstrate the effectiveness of PromptLink. Furthermore, PromptLink is a generic framework without reliance on additional prior knowledge, context, or training data, making it well-suited for concept linking across various types of data sources. The source code of this study is available at https://github.com/constantjxyz/PromptLink.",
    "sections": [
        {
            "section_id": "1",
            "parent_section_id": null,
            "section_name": "1. Introduction",
            "text": "Biomedical concept linking addresses the complex task of aligning related concepts across different data sources by using their semantic meanings and underlying biomedical knowledge (Sevgili et al., 2022  ###reference_b30###). This linking process is essential for integrating analyzes, as diverse biomedical concepts provide a multifaceted view of biomedical knowledge and data (Su et al., 2023  ###reference_b33###; Lu et al., 2023  ###reference_b20###). For instance, electronic health records (EHRs) are valuable assets for patient health analysis, containing a range of digital medical information such as tabular data and clinical notes (Abul-Husn and Kenny, 2019  ###reference_b2###; Sun et al., 2018  ###reference_b34###; Xu et al., 2022  ###reference_b40###). Similarly, knowledge graphs (KGs) play a critical role in biomedical research, offering structured knowledge like definitions of concepts and their relationships (Ma et al., 2018  ###reference_b22###).\n\nDespite their importance, cross-source biomedical linking is challenging due to variations in naming conventions across systems (Kohane et al., 2021  ###reference_b16###). For example, a KG might list a disease as “Ellis-Van Creveld syndrome”, while an EHR may use “Chondroectodermal dysplasia” to refer to the same condition, creating barriers to cohesive data analysis. \n\nConventional methods have targeted these challenges by establishing string-matching rules (D’Souza and Ng, 2015  ###reference_b8###; Kang et al., 2013  ###reference_b14###) and using constructed thesauri (Aronson and Lang, 2010  ###reference_b4###; Savova et al., 2010  ###reference_b28###; Friedman et al., 2001  ###reference_b10###), but their dependence on fixed rules limits their adaptability in real-world conditions (Shi et al., 2023  ###reference_b31###).\n\nTo address these issues, machine learning (ML) methods have been explored, which avoid manually designing rules or thesauri by converting biomedical concepts from raw text into embeddings (latent vector representations) that are then used for computing similarity scores with learning-based scoring functions. Various models have been developed to obtain these embeddings, particularly pre-trained language models (PLMs) (Wang et al., 2023b  ###reference_b35###) that capture detailed semantic relations through extensive training on biomedical corpora (Xu et al., 2020  ###reference_b39###; Lee et al., 2020  ###reference_b17###; Alsentzer et al., 2019  ###reference_b3###; Liu et al., 2021  ###reference_b18###), and graph neural networks (GNNs) (Zhou et al., 2020  ###reference_b43###) which also understand the relationships of biomedical concepts (Bordes et al., 2013  ###reference_b5###; Grover and Leskovec, 2016  ###reference_b11###; Liu et al., 2022  ###reference_b19###).\n\nDespite successes, these ML methods demand extensive data and supervision signals, making them challenging due to expensive data annotation and training processes. Recently, large language models (LLMs) have demonstrated impressive performances in various NLP tasks due to their rich prior knowledge and language capabilities (Zhou et al., 2023  ###reference_b44###; Singhal et al., 2023  ###reference_b32###; Wang et al., 2023a  ###reference_b36###), supporting applications in zero-shot learning settings (Lu et al., 2023  ###reference_b20###).\n\nLLMs' deployment in this task continues to face challenges like designing effective prompts within context length limits (Zhang et al., 2023  ###reference_b41###), and NIL prediction capability for reliably excluding incorrect candidates (Peters et al., 2019  ###reference_b24###).\n\nThis paper presents PromptLink, utilizing LLMs for cross-source biomedical concept linking. PromptLink employs a novel two-stage prompting mechanism in GPT-4 to ensure reliable linking. The first stage filters out irrelevant candidates, minimizing token responses needed for the second stage, which generates final linking results and incorporates a self-verification prompt to improve NIL prediction accuracy. In experimental evaluation, PromptLink significantly outperforms existing methods, showing intrinsic strong biomedical knowledge and generalizing without requiring training processes. As a zero-shot and versatile framework, PromptLink adapts to various biomedical research and application needs effectively."
        },
        {
            "section_id": "2",
            "parent_section_id": null,
            "section_name": "2. Biomedical Concept Linking",
            "text": "I'm sorry, but it seems like there is no specific text from the section of the scientific paper provided in your prompt. Could you please provide the specific text or section that you would like me to revise?"
        },
        {
            "section_id": "2.1",
            "parent_section_id": "2",
            "section_name": "2.1. Problem Definition",
            "text": "The biomedical concept linking task aims to link biomedical concepts across various sources based on semantic meanings and biomedical knowledge, relying solely on concept names. This approach can cover a broad range of real-world applications. It differs from tasks like entity linking, entity alignment, and ontology matching, which depend on additional contextual or topological information.\n\nIn this study, we focus on linking concepts from Electronic Health Records (EHR) to corresponding concepts in a biomedical Knowledge Graph (KG). We define an EHR database and a biomedical KG, along with the linking task, as follows:\n\nAn EHR database is a relational database consisting of patient identifiers, patient attributes, and the values of these attributes. There are also multi-token biomedical concepts associated with patient attributes.\n\nA biomedical KG is a multi-relation graph comprising concepts, relation names, and the relational triples among them.\n\nThe task involves linking identified biomedical concepts from an EHR to a biomedical KG based on their semantic meanings and biomedical knowledge, thereby forming linkages. If a concept from the EHR is not found in the KG, it is linked to a special “NIL” entity, indicating that it is unlinkable."
        },
        {
            "section_id": "2.2",
            "parent_section_id": "2",
            "section_name": "2.2. PromptLink",
            "text": "We propose PromptLink, a novel LLM-based solution for cross-source biomedical concept linking. Addressing LLMs’ high cost and limited input text length, we employ a two-stage prompting mechanism with GPT-4 to generate the final linking predictions.\n\nLinking prediction using two-stage prompts.\n\nThe next step of our framework is generating linking predictions of query using the GPT-4 model, leveraging its text comprehension ability, logical reasoning ability, and prior biomedical knowledge. In this step, we design a novel two-stage prompt for our task.\n\nCombining the two prompts utilizes their strengths and mitigates weaknesses. The first stage focuses on concept pairs to filter out unrelated candidates. The second stage evaluates all candidates in a broader context to identify the closest match or reject all unmatched candidates.\n\nIn the first stage, the LLM is prompted to check if a concept pair should be linked. By defining the response structure, the LLM can return answers in specified formats. To improve the prompt response quality, we adopt the self-consistency prompting strategy that repeatedly prompts the same question to the LLM multiple times.\n\nSpecifically, we prompt each concept pair for multiple times, thus obtaining the belief score. Considering the belief scores across different candidates, we derive a comprehensive filter strategy to exclude irrelevant candidates. This approach ensures that irrelevant candidates are not considered in the next stage, optimizing both efficiency and effectiveness. The approach is described as follows:\n\nIf the similarity indicates some candidates closely align with the query concept, in such cases, candidates with belief scores of zero will be filtered out as they are deemed irrelevant to the query concept. This filtering strategy effectively removes many irrelevant candidates, thereby optimizing efficiency and effectiveness for the subsequent stage.\n\nOtherwise, the range of different candidates’ belief scores is not wide enough to justify filtering. Thus, all candidates will be subjected to double-checking by the second-stage prompt.\n\nIn the second stage, the LLM evaluates the candidates retained from the first stage’s filtering process using a compositional prompt that consists of two consecutive questions to perform complex reasoning.\n\nSpecifically, the LLM is asked to (1) label the relationship between the query concept and all candidate concepts as “exact match”, “related to”, or “different from” and (2) use self-verification prompts to either identify the closest candidate or dismiss all candidates if none are close. Thus, the final concept linking result of this prompt is usually one item from the candidates.\n\nIn this stage, we also use the self-consistency strategy that prompts the same question multiple times. Subsequently, we calculate the occurrence frequency for answers and retrieve the final linking result for the query EHR concept as follows:\n\nIf the result indicates a high probability that none of the candidates are appropriate, “NIL” is chosen as the final linking prediction.\n\nOtherwise, the candidate with the highest frequency is decided as the final linking result. If two candidates tie for the highest frequency, the one with higher alignment to the query concept is chosen."
        },
        {
            "section_id": "3",
            "parent_section_id": null,
            "section_name": "3. Experiments & Discussions",
            "text": ""
        },
        {
            "section_id": "3.1",
            "parent_section_id": "3",
            "section_name": "3.1. Implementation Details",
            "text": "Datasets.\nIn our experiments, we curate two biomedical concept linking benchmark datasets: MIID (MIMIC-III-iBKH-Disease) and CISE (CRADLE-iBKH-Side-Effect).\nMIID comprises 1,493 diagnosis concepts from MIMIC-III, which is an EHR dataset including over 53,423 hospital patient records, and 18,697 disease concepts from iBKH, which is a KG dataset with 2,384,501 entities. To construct MIID, we first remove exact matches between MIMIC-III diagnosis concepts and iBKH disease concepts. Then, we link the remaining MIMIC concepts to iBKH using ICD-9 and UMLS CUI codes. We use the linked concept pairs as ground-truth labels only for evaluation purposes.\nCISE contains 1,500 CRADLE diagnosis concepts and 4,251 iBKH drug side-effect concepts, constructed by using CUI and SNOMED CT codes. Ground-truth matched pairs are also only used for evaluation purposes.\n\nExperimental Settings.\nFollowing the definition in Sec. 2.1 and recognizing the scarcity of supervision in the biomedical domain, we mainly focus on the biomedical concept linking under the zero-shot setting.\nAdditionally, our biomedical concept linking task solely relies on concept names for broad real-world application coverage.\nGiven this characteristic of our data input, graph-based linking methods, such as selfKG, are not applicable as they need topological information to establish concept alignment.\nSimilarly, thesauri-based methods, such as MetaMap, are unsuitable as they only establish links between EHR concepts and KG concepts existing in the pre-defined vocabulary.\nTherefore, the following baseline methods are compared:\nConventional methods: Jaccard Distance, Levenshtein Distance, Jaro-Winkler Distance, BM25. These methods measure the concept pairs’ string similarity and relevance and then obtain the linking prediction result.\nMachine learning-based methods: Pre-trained language models are used to generate concept embedding and linking prediction results. Specifically, we select representative PLMs including BioClinicalBERT, BioDistilBERT, KRISSBERT, and ada002."
        },
        {
            "section_id": "3.2",
            "parent_section_id": "3",
            "section_name": "3.2. Concept Linking Experiment Results",
            "text": "###table_1### Table 1  ###reference_### shows the accuracy of our proposed PromptLink along with baseline methods, when every method links a query EHR concept with their predicted top-1 KG concept.\nAs can be seen, PromptLink outperforms competing approaches across both datasets in terms of zero-shot accuracy, underscoring the superiority of our LLM-based concept linking methodology.\nMoreover, conventional methods based on string similarity lag behind machine learning techniques, which leverage embeddings from pre-trained language models to effectively match conceptually similar but lexically distinct entities like “Ellis-Van Creveld syndrome” and “Chondroectodermal dysplasia”."
        },
        {
            "section_id": "3.3",
            "parent_section_id": "3",
            "section_name": "3.3. Ablation Studies",
            "text": "Prompt Effectiveness and Efficiency.\nWe conduct ablation studies to reveal the effectiveness and cost-efficiency of the prompt used in our approach, as shown in Table 2. This comparison uses the same input data and 10 linking candidates across various prompts. In the table, the “Before prompting” denotes the performance of using only embedding similarity obtained from the pre-trained LM, while other methods use LLM to predict linking results based on LM-generated candidates.\nFrom Table 2, the “Before Prompting” method achieves the worst accuracy, demonstrating that linking performance could be improved by using LLM. Notably, PromptLink with both two-stage prompts achieves the best accuracy with the second-highest cost (M total tokens, costing approximately $66.25), indicating that the combined effect of the prompts substantially enhances accuracy, with the costs being moderated by the first stage’s proficiency in eliminating unrelated candidates.\n\nNIL Prediction.\nAnother ablation study examines PromptLink’s NIL prediction ability. In our built MIID and CISE datasets, each query EHR concept is designed to have a ground-truth linking KG concept. To reflect the real-world unlinkable scenario, we extend our MIID dataset into “MIID-NIL” which contains a proportion of unlikable EHR concepts. In Figure 3, the overall accuracy of PromptLink in the MIID-NIL dataset is 0.8145. Specifically for the unlikable concepts, PromptLink outputs the expected “NIL” with 0.9290 accuracy, which validates the NIL prediction ability of our proposed method."
        },
        {
            "section_id": "3.4",
            "parent_section_id": "3",
            "section_name": "3.4. Case Studies",
            "text": "In case studies on linking EHR concepts to MIID’s KG disease concepts, three scenarios are presented: (1) concepts assessed by both ground-truth labels and a clinician; (2) concepts evaluated by a clinician due to missing ground-truth labels; (3) irrelevant concepts judged by a clinician. \n\nOverall, PromptLink could link biomedical concepts more accurately and appropriately. For cases I-V, PromptLink’s linking results are justified by the ground-truth label and clinician. Specifically, for cases I and II, PromptLink accurately links the EHR concepts to conceptually similar but lexically distinct KG concepts. This difference showcases the effective use of LLM’s biomedical knowledge. PromptLink’s predictions are more accurate and specific.\n\nFor cases VI-IX, where linking ground truth labels are lacking, PromptLink’s predictions also align more accurately with EHR concepts, according to a clinician’s review. In cases VI and VII, PromptLink closely matches the EHR concepts. In cases VIII and IX, PromptLink correctly and automatically identifies no matching KG disease concepts."
        },
        {
            "section_id": "4",
            "parent_section_id": null,
            "section_name": "4. Conclusion",
            "text": "In this study, we introduce PromptLink, a novel framework leveraging LLMs and multi-stage prompts for effective biomedical concept linking. Compared with previous concept linking methods, PromptLink achieves better linking accuracy, attributed to LLM’s intrinsic strong biomedical knowledge. PromptLink further employs multi-stage prompts to maintain cost-efficiency and handle the NIL prediction problem. Moreover, PromptLink functions as a zero-shot framework, requiring no training and demonstrating strong flexibility and generalizability across biomedical systems. Promising future work can focus on further enhancing the prompt effectiveness, reducing costs, and minimizing manual efforts, aiming to extend PromptLink’s application to broader systems."
        }
    ]
}