{
    "title": "Residual-based Language Models are Free Boosters for Biomedical Imaging Tasks",
    "abstract": "In this study, we uncover the unexpected efficacy of residual-based large language models (LLMs) as part of encoders for biomedical imaging tasks, a domain traditionally devoid of language or textual data. The approach diverges from established methodologies by utilizing a frozen transformer block, extracted from pre-trained LLMs, as an innovative encoder layer for the direct processing of visual tokens. This strategy represents a significant departure from the standard multi-modal vision-language frameworks, which typically hinge on language-driven prompts and inputs. We found that these LLMs could boost performance across a spectrum of biomedical imaging applications, including both 2D and 3D visual classification tasks, serving as plug-and-play boosters. More interestingly, as a byproduct, we found that the proposed framework achieved superior performance, setting new state-of-the-art results on extensive, standardized datasets in MedMNIST-2D and 3D. Through this work, we aim to open new avenues for employing LLMs in biomedical imaging and enriching the understanding of their potential in this specialized domain. Our code is available at https://github.com/ZhixinLai/LLMBoostMedical",
    "sections": [
        {
            "section_id": "1",
            "parent_section_id": null,
            "section_name": "Introduction",
            "text": "Modern healthcare research is multifaceted, integrating various disciplines and technologies to improve patient outcomes [12  ###reference_b12###], healthcare delivery [15  ###reference_b15###], and disease prevention [35  ###reference_b35###].\nOne of the most critical components is biomedical imaging. The ability to classify and segment medical images accurately and swiftly is essential for clinicians, reducing errors and improving patient care. Recent advancements in artificial intelligence (AI) for vision [71  ###reference_b71###, 73  ###reference_b73###, 26  ###reference_b26###, 67  ###reference_b67###], such as Vision Transformers (ViTs), have significantly contributed to these areas. These AI models enhance the accuracy and efficiency of medical image analysis, aiding in the development of computer-aided diagnostic systems in clinical applications. By learning from large volumes of medical data, AI technologies can produce accurate diagnostic results across a range of medical applications. Their performance is often comparable to that of experienced clinicians, highlighting the transformative impact of AI in healthcare and its growing role in improving diagnostic processes.\n###figure_1### Despite the promising capabilities of ViTs in biomedical imaging, we still face significant challenges that hinder further performance enhancements. First, the challenge lies in the data requirement for training these models. Effective training demands extensive, meticulously labeled datasets. Unlike other industries such as transportation [14  ###reference_b14###], energy [56  ###reference_b56###], manufacturing [72  ###reference_b72###, 13  ###reference_b13###, 16  ###reference_b16###, 63  ###reference_b63###], agriculture [70  ###reference_b70###, 59  ###reference_b59###], etc., where the data collection and labeling process can be easily standardized, in the realm of biomedical imaging, creating such datasets is particularly burdensome. The need for expert knowledge is paramount due to the fine-grained nature of medical images. This process is not only time-intensive but also incurs significant financial costs, making it a substantial barrier to progress. Second, the optimization of ViT presents a critical challenge similar to the broader computer vision domain. Achieving the best performance necessitates rigorous parameter tuning, a process that requires a deep understanding of the model architecture and consumes considerable computational resources. This level of optimization, while crucial for maximizing model efficacy, is a demanding task that often stretches beyond practical limits in terms of time and computational expense. Confronted with these two significant challenges, this research focuses on exploring strategies to enhance the performance of ViT in biomedical imaging without accumulating larger datasets or dramatically increasing computational demands.\n###figure_2### LLMs, trained on extensive textual data, have shown impressive versatility, applying their capabilities far beyond their initial linguistic applications. In computer vision, for instance, LLMs have demonstrated an intriguing capacity to engage with and interpret visual tokens, converting them into a structured, tokenized format. This integration often occurs within a multi-modal vision-language framework. Here, visual tokens are typically interfaced with LLMs through linear projection layers, or by employing cross-attention mechanisms that facilitate interaction between visual and linguistic tokens. As we delve deeper into the potential of LLMs in computer vision, a compelling question emerges: Can these models, originally designed for language processing, adeptly manage purely visual tasks, without any dependence on linguistic elements?\nIn pursuit of understanding the capability of LLMs in visual tasks, our research offers a novel and affirmative insight. We introduce an approach that has been largely unexplored until now: utilizing a residual-based LLM (R-LLM) block as an efficient encoder for visual data. This method is distinct in its simplicity and effectiveness, with a significant performance boost on biomedical imaging tasks, as shown in Figure 1  ###reference_###. Specifically, it involves three integral steps, as depicted in Figure 2  ###reference_###: Firstly, we integrate a frozen transformer block from an LLM into the visual encoder’s architecture. Secondly, to ensure compatibility and effective information transfer, trainable linear layers are strategically positioned around the LLM block, enabling seamless feature dimension alignment. Third, a residual connection before and after the frozen LLM is introduced. Finally, while the transformer block remains frozen to retain its pre-trained characteristics, the other modules are unfrozen and undergo regular optimization during the training phase.\nRemarkably, the proposed straightforward approach yields significant performance improvements across a broad range of tasks in biomedical imaging, including both 2D and 3D classification tasks. This enhancement is consistently observed with various publicly available large language models, such as LLaMA, and across different transformer blocks within these LLMs. As shown in Figure 2  ###reference_###-(a), the methodology innovates by treating LLM transformers as a booster of biomedical encoders, deviating significantly from the traditional perspective in vision-language models. Three key features distinguish our application of LLM transformers: First, their operation is entirely independent of language components, such as prompts, inputs, or outputs, marking a significant departure from traditional usage. Second, our method is adaptable both with and without pre-training, providing flexibility and bypassing the reliance on pre-trained models. Third, we simplify using LLMs by treating transformer blocks as distinct, modular units. This innovative approach not only challenges but also reshapes the conventional application of LLMs, particularly in the complex field of biomedical imaging tasks. In summary, our paper makes the following primary contributions:\nWe introduce a novel residual-based framework that incorporates a frozen transformer block from pre-trained LLMs as a visual encoder layer, enhancing the learning of various biomedical imaging tasks. This innovative approach is tailored to adapt to the diverse and complex nature of biomedical images.\nExtensive experiments have been conducted across multiple datasets and scales, including BreastMNIST, DermaMNIST, FractureMNIST3D, etc. Surprisingly, the approach achieves state-of-the-art (SoTA) results, surpassing the performance of previous models. This underscores the effectiveness of our method in a wide array of medical imaging contexts.\nWe provide in-depth discussions and ablation studies to dissect and understand the components of our proposed framework. These studies offer insights into the functionality and efficacy of each module, providing a comprehensive understanding of why and how our approach achieves its superior performance."
        },
        {
            "section_id": "2",
            "parent_section_id": null,
            "section_name": "Related Work",
            "text": ""
        },
        {
            "section_id": "2.2",
            "parent_section_id": "2",
            "section_name": "Vision Transformer",
            "text": "The Vision Transformer introduced by [26  ###reference_b26###] exemplifies how a purely transformer-based model can achieve notable success in image classification. In ViT, images are divided into patches (tokens), and transformer layers are utilized to model the global interrelations among these patches for effective classification. Building upon this, the T2T-ViT [78  ###reference_b78###] refines the tokenization process by recursively aggregating neighboring tokens, thereby enriching the representation of local structures. Similarly, the Swin Transformer [48  ###reference_b48###] introduces a local window-based self-attention mechanism, with a shifted window scheme for comprehensive in-window and cross-window interaction modeling. The advent of Vision Transformers (ViT) has led to an increasing number of applications [81  ###reference_b81###, 76  ###reference_b76###]. In biomedical imaging, these technologies have also led to more accurate and efficient medical image segmentation and classification [27  ###reference_b27###, 20  ###reference_b20###, 62  ###reference_b62###], leveraging transformers to handle variable-length inputs and capture long-distance dependencies."
        },
        {
            "section_id": "2.3",
            "parent_section_id": "2",
            "section_name": "Language Models for Visual and Biomedical Imaging Tasks",
            "text": "In the general vision domain, the advent of large language models (LLMs) has catalyzed a wave of innovative applications due to their generative capabilities. Notably, LLMs are being utilized to merge vision algorithms with user queries, enabling more interactive and user-specific outcomes, as explored in recent studies [47  ###reference_b47###, 55  ###reference_b55###]. Another area of advancement is in visual programming, where LLMs play a central role in visual reasoning and in-context learning [29  ###reference_b29###, 46  ###reference_b46###]. Furthermore, the versatility of LLMs as decoders is increasingly recognized, with their ability to translate latent visual features into meaningful output tokens [64  ###reference_b64###, 83  ###reference_b83###]. Common methodologies in this domain involve projecting visual features directly onto the input layers of LLMs [28  ###reference_b28###, 44  ###reference_b44###, 50  ###reference_b50###], or leveraging latent bottleneck structures to encode visual tokens more effectively [37  ###reference_b37###, 3  ###reference_b3###, 43  ###reference_b43###, 64  ###reference_b64###].\nIn line with this advancement, image tasks, such as image classification [79  ###reference_b79###], image segmentation [22  ###reference_b22###], pattern recognition [34  ###reference_b34###], detection [25  ###reference_b25###], and AR/VR technology [57  ###reference_b57###], are following this trend of using language models. Researchers in the biomedical imaging field have developed datasets that bridge the gap between vision and language [36  ###reference_b36###, 65  ###reference_b65###]. Utilizing these specialized datasets, significant advancements have been made in applying general-domain vision-language models to biomedical imaging [7  ###reference_b7###, 82  ###reference_b82###, 33  ###reference_b33###]. A good example is utilizing vision-language pre-training (VLP) to incorporate domain knowledge from medicine into visual representation learning, as demonstrated in 2D and 3D image analysis [45  ###reference_b45###]. These models have shown promising results in enhancing the analysis and interpretation of medical images. However, they still require careful alignment between the visual and linguistic modalities or an additional mapping process to translate visual information into the language space.\nRecent advancements in the vision domain have illuminated the potential of using transformer blocks from LLMs as general-purpose encoder layers for visual data [51  ###reference_b51###]. This perspective marks a departure from their traditional roles, primarily confined to encoding textual data, decoding tokenized outputs, or facilitating alignment between modalities. Instead, the pre-trained blocks may discern informative visual tokens and amplify their impacts on feature representation. Inspired by this, we hypothesize that a similar idea could be effectively adapted to biomedical imaging tasks."
        },
        {
            "section_id": "3",
            "parent_section_id": null,
            "section_name": "Method",
            "text": "In this section, we first introduce the overall framework of the proposed method in Section 3.1  ###reference_###. Following this, we highlight the key design and differences between the framework and previous methods in Section 3.2  ###reference_###."
        },
        {
            "section_id": "3.1",
            "parent_section_id": "3",
            "section_name": "The Overall Framework",
            "text": "We now formally introduce our comprehensive framework that harnesses the power of LLM as a free booster for biomedical imaging tasks. The entire workflow of this framework is delineated in Figure 2  ###reference_###. Traditionally, the framework begins by taking a biomedical image as input, denoted as . It then utilizes a vision transformer-based encoder, , to transform  into a feature embedding . This process is followed by a MLP-based classifier  for the final classification task, correlating with the corresponding label . For the supervised learning, we define it as\nFollowing the baseline framework, we incorporate a pre-trained block from LLM, specifically selecting a block from LLaMA [60  ###reference_b60###] in this study. We denote this LLM block as . To effectively integrate  into the vision-based pipeline, we introduce two additional adaptation layers:  and . The layer  is positioned before , while  follows it. These layers serve a critical function in aligning the dimensions between the vision data and the language model, ensuring seamless interoperability and efficient processing within our hybrid framework. Very importantly, we strategically implement a residual connection [30  ###reference_b30###], positioned both before and after the LLM block. This setup allows an efficient exchange of gradient information and the passage of visual embedding through a shortcut path. Such an architecture not only facilitates the learning process but also ensures that crucial information is effectively preserved and communicated across models with different modalities, i.e., vision and language. We formally formulate this as\nDuring training, we freeze all the parameters of , the LLM transformer block. Meanwhile, the rest of the modules, including two adaptation layers,  and , are trained simultaneously. Following the previous paradigm [51  ###reference_b51###], the approach modifies the behavior of LLM transformers to accommodate the stark differences between visual and textual data formats. Specifically, there are two critical adaptations. First, in LLMs, auto-regressive masks are typically used to simulate the sequential nature of text generation. However, in visual data, such as image tokens, the information is presented simultaneously rather than sequentially. Recognizing this, we forgo using auto-regressive attention masks in our framework. Instead, we employ attention masks solely to denote the presence of padded tokens in the visual data. Second, the positional embeddings utilized in LLMs, like the rotary positional embedding in LLaMA [60  ###reference_b60###], are not typically chosen for visual encoders. Hence, for the sake of simplicity and to maintain consistency with conventional visual backbones, we opted to remove the LLMs’ positional embeddings from our system."
        },
        {
            "section_id": "3.2",
            "parent_section_id": "3",
            "section_name": "Comparison with Previous Methods",
            "text": "At first glance, the proposed methods may appear akin to those used in prior vision-language model research, such as in video language retrieval [44  ###reference_b44###], FROMAGe [39  ###reference_b39###], and LiMBeR [50  ###reference_b50###], where bridging the gap between vision and language spaces is achieved through linear layers. However, a distinctive aspect of our approach is the absence of an alignment between these two modalities’ spaces. In essence,  is not constrained to map features directly from the vision to the language space, differing fundamentally from these previous methods. This conclusion and design are consistent with the previous results shown in [51  ###reference_b51###]. To be more specific, the method we propose distinguishes itself in several critical ways. Unlike prevailing approaches, it does not depend on a pre-trained encoder such as CLIP [53  ###reference_b53###], ALBEF [42  ###reference_b42###] and Coca [77  ###reference_b77###], enabling the model to be trained entirely from scratch. This independence from pre-existing models offers greater flexibility and adaptability.\nAdditionally, the method functions and operates autonomously from language-based inputs or prompts, which are applicable to general biomedical imaging Tasks. Most notably, our approach represents a pioneering attempt to employ a residual connection to facilitate information exchange among different modalities, a design particularly novel in biomedical imaging. These three aspects - independence from pre-trained models, autonomy from language-based inputs, and the innovative use of residual connections across modalities - collectively underscore the distinctiveness and innovation of our method in advancing biomedical imaging technology."
        },
        {
            "section_id": "4",
            "parent_section_id": null,
            "section_name": "Experinments and Results",
            "text": "In this section, we conduct extensive empirical evaluations and experiments to validate the effectiveness of our proposed method as a cost-free, plug-and-play booster for biomedical imaging tasks. We begin by detailing the datasets utilized in our study in Section 4.1  ###reference_###. Subsequently, in Section 4.2  ###reference_###, we delve into the experiments conducted on 2D classification tasks. Following this, Section 4.3  ###reference_### will cover the 3D classification tasks, providing insights into the implementation details, experiments conducted, and the results derived from these tasks.\nLastly, we conduct a series of ablation studies to understand and explore variants of the proposed method in Section 4.4  ###reference_###."
        },
        {
            "section_id": "4.1",
            "parent_section_id": "4",
            "section_name": "Datasets",
            "text": "We carefully selected datasets from MedMNIST V2 [75  ###reference_b75###], supplemented with other public datasets. Specifically, the chosen datasets encompass a broad spectrum of imaging types featuring both 2D and 3D images. Additionally, these datasets provide a diverse range of classification challenges, including both binary and multi-class tasks.\nWe commence our testing with a foundational 2D dataset, comprising 780 images, to carry out binary classification tasks. This initial phase is for a preliminary evaluation of our proposed approach. Progressing from there, we expand the scale of the datasets under investigation, transitioning from hundreds to over 100,000 images. Given the limited availability of 3D datasets, our selection for 3D image analysis includes four datasets, each containing thousands of images under similar scales. We described the details of the datasets as follows:\nBreastMNIST, drawing from a dataset of 780 breast ultrasound images [2  ###reference_b2###], classifies these images into three categories: benign, malignant, and normal. Given that the dataset comprises low-resolution images, the task has been simplified into a binary classification framework.\nRetinaMNIST is derived from the DeepDRiD (Deep Diabetic Retinopathy) dataset [11  ###reference_b11###], featuring data from 628 patients and encompassing 1600 retina fundus images.\nPneumoniaMNIST, adapted from an existing dataset [52  ###reference_b52###], is comprised of 5,856 pediatric chest X-ray images. This dataset is particularly focused on the classification of pneumonia and is structured into two binary classes: ‘pneumonia’ and ‘normal.’\nDermaMNIST is derived from the HAM10000 dataset [61  ###reference_b61###], a substantial compilation of multi-source dermatoscopic images showcasing common pigmented skin lesions. This dataset encompasses 10,015 dermatoscopic images, each with dimensions of 450 × 600 pixels.\nOCTMNIST is derived from a previously established dataset [21  ###reference_b21###], consisting of 109,309 valid optical coherence tomography (OCT) images collected specifically for the study of retinal diseases. The dataset encompasses four distinct types of retinal conditions, which form the basis for a multi-class classification task.\nOrganAMNIST originates from 3D computed tomography (CT) images utilized in the Liver Tumor Segmentation Benchmark (LiTS) [1  ###reference_b1###] with 58,850 images. To obtain organ labels for these images, bounding-box annotations of 11 body organs from a separate study were employed [49  ###reference_b49###].\nFractureMNIST3D is derived from the RibFrac Dataset [4  ###reference_b4###], featuring about 5,000 rib fractures from 660 CT scans. We adhere to the official dataset division for experiments.\nAdrenalMNIST3D, derived from Zhongshan Hospital affiliated with Fudan University, encompasses shape masks from 1,584 adrenal glands (792 patients). It includes 3D shapes of adrenal glands for binary classification. This dataset is randomly divided into training, validation, and test sets, with 1,188, 98, and 298 cases, respectively, ensuring a patient-level split.\nNoduleMNIST3D is developed from a substantial public lung nodule dataset derived from thoracic CT scans. The dataset is partitioned in a 7:1:2 ratio into training, validation, and test sets. The images, spatially normalized to a 1mm×1mm×1mm spacing, are center-cropped to a uniform size of 28×28×28 for analysis.\nVesselMNIST3D comprises 103 3D brain vessel models derived from reconstructed MRA images. From these models, 1,694 healthy vessel segments and 215 aneurysm segments have been generated. The source dataset has been divided into training, validation, and test sets in a 7:1:2 ratio, facilitating a comprehensive evaluation of the models across various samples.\n###table_1###"
        },
        {
            "section_id": "4.2",
            "parent_section_id": "4",
            "section_name": "2D Classification",
            "text": "We now dive into the experiments of 2D classification tasks for biomedical images. We will first introduce the detailed implementation and then move to the corresponding results."
        },
        {
            "section_id": "4.2.1",
            "parent_section_id": "4.2",
            "section_name": "4.2.1 Implementation Details",
            "text": "For 2D classification experiments, all images are initially resized to a resolution of 224 x 224 pixels. We train each model using a batch size of 128, employing an AdamW optimizer for 100 epochs. The initial learning rate is set at 0.0005, coupled with a weight decay of 0.05. We utilize the ViT small model as the encoder pre-trained on ImageNet along with the llama-7b while keeping all parameters unfrozen for end-to-end training, except those in the LLaMA model. All these experiments are carried out on NVIDIA A6000 GPUs."
        },
        {
            "section_id": "4.2.2",
            "parent_section_id": "4.2",
            "section_name": "4.2.2 Results",
            "text": "In demonstrating the effectiveness of the R-LLM as a booster for 2D classification tasks, we primarily utilize Accuracy (ACC) and Area under the ROC Curve (AUC) as evaluation metrics. ACC, being a threshold-based metric, is particularly sensitive to class discrepancy as it evaluates discrete prediction labels. In contrast, AUC is a threshold-free metric suited for assessing continuous prediction scores. Given the diversity in dataset sizes and types in our experiments, employing both ACC and AUC provides a comprehensive assessment of our method’s performance across varying conditions.\nThe results in Table 1  ###reference_### demonstrate that integrating the LM consistently enhances performance across various datasets and evaluation metrics. Notably, the most significant accuracy gains, approximately 1 to 3 percent, are observed in datasets such as RetinMNIST, OCTMNIST, and DermaMNIST. While improvements in other datasets are less pronounced, this could be attributed to our approach of applying a uniform set of hyperparameters across all experiments to showcase the LM’s general applicability. The relatively modest enhancements in certain cases might result from this methodological choice, as it potentially limits the fine-tuning of hyperparameters tailored to each specific dataset’s characteristics. Interestingly, we noticed that R-LLM did not contribute to improving the ACC metric in the PneumoniaMNIST dataset. This observation can be attributed to the dataset’s imbalanced nature, with a pneumonia-to-normal ratio of approximately 3:1. Consequently, accuracy can be misleading in such an imbalanced setting, as the baseline may achieve better accuracy simply by predicting most samples as the majority class. As we switch from ACC to AUC, we can see a more fair comparison and consistently observe that R-LLM continues to benefit the classification tasks.\nMore surprisingly, when the LLM booster is integrated into the basic ViT model, it not only matches but, in some cases, even surpasses existing SoTA results. As outlined in Table 2  ###reference_###, this novel approach achieves unparalleled accuracy in datasets like BreastMNIST, RetinaMNIST, DermaMNIST, and OCTMNIST. Most notably, our method outperforms the SoTA on OCTMNIST by a remarkable margin of nearly 7 percent."
        },
        {
            "section_id": "4.3",
            "parent_section_id": "4",
            "section_name": "3D Classification",
            "text": "We now move to the experiments of 3D classification tasks for biomedical images. Similarly, we will first introduce the detailed implementation and then the corresponding results."
        },
        {
            "section_id": "4.3.1",
            "parent_section_id": "4.3",
            "section_name": "4.3.1 Implementation Details",
            "text": "For the 3D classification experiments, each model is trained using a batch size of 128, employing an AdamW optimizer across 100 epochs. The initial learning rate is . We adopt the ViViT [5  ###reference_b5###] and ViT3D [26  ###reference_b26###], both modified with three channels to accommodate the 3D input, alongside the llama-7b model. The ViT3D model comprises 130.3M parameters. For ViVit, we utilize two encoder sizes: ViVit-Small (ViViT-S) and ViT-Medium (ViViT-M), containing 49.2M and 258.6M parameters, respectively. All parameters, except for those in LLaMA, are kept unfrozen for end-to-end training. These experiments are conducted on NVIDIA A6000 GPUs."
        },
        {
            "section_id": "4.3.2",
            "parent_section_id": "4.3",
            "section_name": "4.3.2 Results",
            "text": "Similar to the 2D datasets, we present the results for 3D datasets, reinforcing the core assertion of this paper: that LMs serve as a free booster for general bioimaging tasks, including 3D analysis. As illustrated in Table 3  ###reference_###, the results are reported for various datasets with and without the R-LLM incorporated. These results are spread across different types and scales of encoders, specifically including ViT3D, ViViT-S, and ViViT-M. Crucially, in all scenarios and across both ACC and AUC evaluation metrics, we observe marked improvements in model performance. This consistent enhancement underscores the versatility and effectiveness of the LLM as a booster in the realm of 3D biomedical imaging tasks.\nFor the comprehensive experiments, we follow the 2D experiment settings to compare the proposed method with previous SoTA approaches. Remarkably, in Table 4  ###reference_###, our framework notched three SoTA results across four datasets, without any additional hyperparameter tuning. Meanwhile, even more favorable outcomes might be attainable with further optimization and customization of training parameters."
        },
        {
            "section_id": "4.4",
            "parent_section_id": "4",
            "section_name": "Ablation and Visualization",
            "text": "To further prove the effectiveness of the proposed idea and the importance of the introduced LLM block, we conduct comprehensive experiments with models of varying capacities, detailed in Section 4.4.1  ###reference_.SSS1###. In these experiments, we assess how the models perform with different levels of complexity. Subsequently, in Section 4.4.2  ###reference_.SSS2###, we explore the potential benefits of unfreezing the LLM block. This step is aimed at fully leveraging the adaptability and fitting power of the LLM. Then, we highlight the importance of residual structure in Section 4.4.3  ###reference_.SSS3###. Lastly, Crad-CAM visualization is given in Secionn 4.4.4  ###reference_.SSS4###."
        },
        {
            "section_id": "4.4.1",
            "parent_section_id": "4.4",
            "section_name": "4.4.1 Model with Different Capacities",
            "text": "In evaluating the broad effectiveness of frozen LLM transformers, we considered whether the improvements could be attributed more to the expanded capacity of the linear adaptation layers, namely  and , rather than the pre-trained weights of the LLM block, . To investigate this, we created a variant model, ViViT-M+MLP, which has a parameter count equivalent to that of ViViT+R-LLM. This variant omits the LLM block , and keeps  and .\nWe adhered to the same training procedure outlined in Section 4.3  ###reference_### to ensure a fair comparison, focusing our experiments on the FractureMNIST3D and AdrenalMNIST3D datasets. The results, summarized in Table 5  ###reference_###, show that ViViT-M+MLP, with its increased number of parameters, does outperform the baseline ViViT-M model. However, the improvement is relatively marginal. In contrast, the enhancement observed with ViViT-M+R-LLM is both robust and substantial across both metrics. These findings lead to a significant conclusion: the pre-trained weights of the LLM transformer are instrumental to the observed improvements, and the enhancements in our biomedical imaging tasks are not merely the result of increased model capacity."
        },
        {
            "section_id": "4.4.2",
            "parent_section_id": "4.4",
            "section_name": "4.4.2 End-to-end Fine-tuning",
            "text": "In examining whether fine-tuning the language transformer in the ViViT-M+R-LLM(FT) model is advantageous compared to maintaining it in a frozen state, we found an unexpected outcome. The results, as shown in Table 5  ###reference_###, indicate a decline in performance with fine-tuning, in contrast to the consistent training of the ViViT-M+R-LLM. This suggests the difficulties in training large transformer models: there is a tendency to overfit with standard-scale datasets, and fine-tuning LLMs end-to-end is often time-intensive and complex. This observation reinforces our decision to keep the LLM transformers frozen within our framework. By doing so, we simplify the training process while also ensuring effectiveness, thereby avoiding the challenges associated with fine-tuning in complex transformer architectures.\n###figure_3###"
        },
        {
            "section_id": "4.4.3",
            "parent_section_id": "4.4",
            "section_name": "4.4.3 Importance of Residual Structure",
            "text": "In this ablation study, the significance of the residual structure within our framework is meticulously examined. We found that incorporating such a structure in tandem with a Large Language Model (LLM) substantially enhances model performance. To elucidate this further, we introduce two variants of our Residual-based R-LLM: the ‘Out R-LLM’ and the Hybrid R-LLM. Out R-LLM is designed to incorporate the residual connection before the encoder  and externally to the decoder . This can be summarized as follows:\nHybrid R-LLM, blending the features of R-LLM and Out R-LLM, combines both internal and external residual structures. This approach offers an alternative method of integration. In line with our previous experiments, the performance of Hybrid R-LLM is evaluated on FractureMNIST3D and AdrenalMNIST3D datasets using the ACC and AUC metrics. The findings, presented in Table 6  ###reference_###, indicate that while R-LLM delivers the best results. However, any form of the residual structure consistently benefits the overall performance."
        },
        {
            "section_id": "4.4.4",
            "parent_section_id": "4.4",
            "section_name": "4.4.4 Visual Inspection",
            "text": "To validate the efficiency of LLM, we utilize Grad-CAM [54  ###reference_b54###] to qualitatively analyze the performance of ViT-S with R-LLM. We conduct training on the original OCTMNIST dataset [21  ###reference_b21###], encompassing diverse retinal conditions: Choroidal Neovascularization (CNV), Diabetic Macular Edema (DME), Drusen, and Normal cases.\nIn Figure 3  ###reference_###, significant regions are delineated by red rectangles, indicating areas crucial for medical diagnosis and analysis. Compared to the baseline, ViT-S enhanced with R-LLM demonstrates superior performance by closely aligning with these annotated red rectangles. This alignment enhances its ability to suppress attention toward extraneous background details effectively and to identify pivotal features essential for accurate diagnosis and analysis. This observation underscores the efficacy of our approach in medical image analysis tasks."
        },
        {
            "section_id": "5",
            "parent_section_id": null,
            "section_name": "Discussion and Conclusion",
            "text": ""
        },
        {
            "section_id": "5.1",
            "parent_section_id": "5",
            "section_name": "Discussion",
            "text": "This study was primarily focused on methodically exploring a relatively under-investigated domain: the utility of pre-trained, frozen, and residual-based language transformers in biomedical imaging tasks. We have successfully demonstrated that these transformers can indeed serve as a ’free lunch’, significantly boosting performance across various tasks. The experiments were carefully structured to cover a broad range of datasets and learning tasks, ensuring fair and meaningful comparisons with established baselines. Our focus was not exclusively on achieving state-of-the-art performance for every task, although this emerged as an unintended but welcome byproduct of our work.\nThis research not only confirms the value of LLMs in enhancing biomedical visual tasks but also opens the door for further exploration in this field. We urge fellow researchers to expand upon our work, potentially by enlarging the scope of experiments with more diverse datasets and learning tasks, not only in vision and NLP, but also Tabular [58  ###reference_b58###, 74  ###reference_b74###, 17  ###reference_b17###], Graph [68  ###reference_b68###, 18  ###reference_b18###], etc., which could lead to more universally applicable models in the industry. Moreover, we also recognize that our approach has not yet fully harnessed the specific traits of biomedical images, such as their fine-grained structures. Delving into these aspects could yield more nuanced insights and improvements, representing a vital and promising direction for future studies."
        },
        {
            "section_id": "5.2",
            "parent_section_id": "5",
            "section_name": "Conclusion",
            "text": "In this research, we explored the unique potential of residual-based large language models, traditionally associated with text processing, as encoders for biomedical imaging tasks. This innovative application marks a significant shift from their usual text-centric roles. By integrating a frozen transformer block from pre-trained LLMs into visual encoders as a free booster, we discovered consistent enhancements in performance across a variety of 2D and 3D biomedical imaging tasks. These findings broaden the scope of LLM applications, suggesting their utility extends well beyond language processing. Our study aims to inspire further exploration in this nascent field, particularly in bridging the modality gap between vision and language and harnessing the full potential of LLMs within the biomedical imaging domain."
        }
    ]
}